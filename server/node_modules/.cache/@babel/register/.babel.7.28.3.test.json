{"{\"assumptions\":{},\"sourceRoot\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/test/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"filename\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/test/auction.test.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"test\",\"root\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-explicit-resource-management\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"BlockStatement\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.28.3:test":{"value":{"code":"\"use strict\";\n\nvar _mocha = require(\"mocha\");\nvar _supertest = _interopRequireDefault(require(\"supertest\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _testServer = require(\"./testServer.js\");\nvar _testHelpers = require(\"./testHelpers.js\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nlet server;\nlet testUser;\nlet authToken;\nlet testAuction;\n\n// Setup and teardown\n(0, _mocha.before)(async () => {\n  await (0, _testHelpers.connectDB)();\n  await (0, _testHelpers.clearDB)();\n\n  // Create a test user and get auth token\n  const userData = await (0, _testHelpers.createTestUser)(_testHelpers.testUser);\n  testUser = userData.user;\n  authToken = userData.token;\n\n  // Create and start the test server\n  server = await (0, _testServer.createTestServer)();\n\n  // Create a test auction\n  testAuction = await (0, _testHelpers.createTestAuction)({\n    seller: testUser._id\n  });\n});\n(0, _mocha.after)(async () => {\n  if (server) {\n    await server.stop();\n  }\n  await (0, _testHelpers.closeDB)();\n});\n(0, _mocha.describe)('Auction API', () => {\n  (0, _mocha.describe)('GET /api/auctions/:id', () => {\n    (0, _mocha.it)('should get a single auction by ID', async () => {\n      const res = await (0, _supertest.default)(server.app).get(`/api/auctions/${testAuction._id}`).expect(200);\n      expect(res.body).to.have.property('_id', testAuction._id.toString());\n      expect(res.body).to.have.property('title', testAuction.title);\n    });\n  });\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9jaGEiLCJyZXF1aXJlIiwiX3N1cGVydGVzdCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfbW9uZ29vc2UiLCJfdGVzdFNlcnZlciIsIl90ZXN0SGVscGVycyIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsInNlcnZlciIsInRlc3RVc2VyIiwiYXV0aFRva2VuIiwidGVzdEF1Y3Rpb24iLCJiZWZvcmUiLCJjb25uZWN0REIiLCJjbGVhckRCIiwidXNlckRhdGEiLCJjcmVhdGVUZXN0VXNlciIsInRlc3RVc2VyRGF0YSIsInVzZXIiLCJ0b2tlbiIsImNyZWF0ZVRlc3RTZXJ2ZXIiLCJjcmVhdGVUZXN0QXVjdGlvbiIsInNlbGxlciIsIl9pZCIsImFmdGVyIiwic3RvcCIsImNsb3NlREIiLCJkZXNjcmliZSIsIml0IiwicmVzIiwicmVxdWVzdCIsImFwcCIsImdldCIsImV4cGVjdCIsImJvZHkiLCJ0byIsImhhdmUiLCJwcm9wZXJ0eSIsInRvU3RyaW5nIiwidGl0bGUiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9waXp6b3N0YS9EZXNrdG9wL0NPRElORy9hdWN0aW9uLXdlYnNpdGUvc2VydmVyL3Rlc3QvIiwic291cmNlcyI6WyJhdWN0aW9uLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBiZWZvcmUsIGFmdGVyIH0gZnJvbSAnbW9jaGEnO1xuaW1wb3J0IHJlcXVlc3QgZnJvbSAnc3VwZXJ0ZXN0JztcbmltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5pbXBvcnQgeyBjcmVhdGVUZXN0U2VydmVyIH0gZnJvbSAnLi90ZXN0U2VydmVyLmpzJztcbmltcG9ydCB7IFxuICBjb25uZWN0REIsIFxuICBjbG9zZURCLCBcbiAgY2xlYXJEQiwgXG4gIGNyZWF0ZVRlc3RVc2VyLCBcbiAgY3JlYXRlVGVzdEF1Y3Rpb24sIFxuICB0ZXN0VXNlciBhcyB0ZXN0VXNlckRhdGFcbn0gZnJvbSAnLi90ZXN0SGVscGVycy5qcyc7XG5cbmxldCBzZXJ2ZXI7XG5sZXQgdGVzdFVzZXI7XG5sZXQgYXV0aFRva2VuO1xubGV0IHRlc3RBdWN0aW9uO1xuXG4vLyBTZXR1cCBhbmQgdGVhcmRvd25cbmJlZm9yZShhc3luYyAoKSA9PiB7XG4gIGF3YWl0IGNvbm5lY3REQigpO1xuICBhd2FpdCBjbGVhckRCKCk7XG4gIFxuICAvLyBDcmVhdGUgYSB0ZXN0IHVzZXIgYW5kIGdldCBhdXRoIHRva2VuXG4gIGNvbnN0IHVzZXJEYXRhID0gYXdhaXQgY3JlYXRlVGVzdFVzZXIodGVzdFVzZXJEYXRhKTtcbiAgdGVzdFVzZXIgPSB1c2VyRGF0YS51c2VyO1xuICBhdXRoVG9rZW4gPSB1c2VyRGF0YS50b2tlbjtcbiAgXG4gIC8vIENyZWF0ZSBhbmQgc3RhcnQgdGhlIHRlc3Qgc2VydmVyXG4gIHNlcnZlciA9IGF3YWl0IGNyZWF0ZVRlc3RTZXJ2ZXIoKTtcbiAgXG4gIC8vIENyZWF0ZSBhIHRlc3QgYXVjdGlvblxuICB0ZXN0QXVjdGlvbiA9IGF3YWl0IGNyZWF0ZVRlc3RBdWN0aW9uKHsgc2VsbGVyOiB0ZXN0VXNlci5faWQgfSk7XG59KTtcblxuYWZ0ZXIoYXN5bmMgKCkgPT4ge1xuICBpZiAoc2VydmVyKSB7XG4gICAgYXdhaXQgc2VydmVyLnN0b3AoKTtcbiAgfVxuICBhd2FpdCBjbG9zZURCKCk7XG59KTtcblxuZGVzY3JpYmUoJ0F1Y3Rpb24gQVBJJywgKCkgPT4ge1xuICBkZXNjcmliZSgnR0VUIC9hcGkvYXVjdGlvbnMvOmlkJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2V0IGEgc2luZ2xlIGF1Y3Rpb24gYnkgSUQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0KHNlcnZlci5hcHApXG4gICAgICAgIC5nZXQoYC9hcGkvYXVjdGlvbnMvJHt0ZXN0QXVjdGlvbi5faWR9YClcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzLmJvZHkpLnRvLmhhdmUucHJvcGVydHkoJ19pZCcsIHRlc3RBdWN0aW9uLl9pZC50b1N0cmluZygpKTtcbiAgICAgIGV4cGVjdChyZXMuYm9keSkudG8uaGF2ZS5wcm9wZXJ0eSgndGl0bGUnLCB0ZXN0QXVjdGlvbi50aXRsZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsVUFBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBRCxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUksV0FBQSxHQUFBSixPQUFBO0FBQ0EsSUFBQUssWUFBQSxHQUFBTCxPQUFBO0FBTzBCLFNBQUFFLHVCQUFBSSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRTFCLElBQUlHLE1BQU07QUFDVixJQUFJQyxRQUFRO0FBQ1osSUFBSUMsU0FBUztBQUNiLElBQUlDLFdBQVc7O0FBRWY7QUFDQSxJQUFBQyxhQUFNLEVBQUMsWUFBWTtFQUNqQixNQUFNLElBQUFDLHNCQUFTLEVBQUMsQ0FBQztFQUNqQixNQUFNLElBQUFDLG9CQUFPLEVBQUMsQ0FBQzs7RUFFZjtFQUNBLE1BQU1DLFFBQVEsR0FBRyxNQUFNLElBQUFDLDJCQUFjLEVBQUNDLHFCQUFZLENBQUM7RUFDbkRSLFFBQVEsR0FBR00sUUFBUSxDQUFDRyxJQUFJO0VBQ3hCUixTQUFTLEdBQUdLLFFBQVEsQ0FBQ0ksS0FBSzs7RUFFMUI7RUFDQVgsTUFBTSxHQUFHLE1BQU0sSUFBQVksNEJBQWdCLEVBQUMsQ0FBQzs7RUFFakM7RUFDQVQsV0FBVyxHQUFHLE1BQU0sSUFBQVUsOEJBQWlCLEVBQUM7SUFBRUMsTUFBTSxFQUFFYixRQUFRLENBQUNjO0VBQUksQ0FBQyxDQUFDO0FBQ2pFLENBQUMsQ0FBQztBQUVGLElBQUFDLFlBQUssRUFBQyxZQUFZO0VBQ2hCLElBQUloQixNQUFNLEVBQUU7SUFDVixNQUFNQSxNQUFNLENBQUNpQixJQUFJLENBQUMsQ0FBQztFQUNyQjtFQUNBLE1BQU0sSUFBQUMsb0JBQU8sRUFBQyxDQUFDO0FBQ2pCLENBQUMsQ0FBQztBQUVGLElBQUFDLGVBQVEsRUFBQyxhQUFhLEVBQUUsTUFBTTtFQUM1QixJQUFBQSxlQUFRLEVBQUMsdUJBQXVCLEVBQUUsTUFBTTtJQUN0QyxJQUFBQyxTQUFFLEVBQUMsbUNBQW1DLEVBQUUsWUFBWTtNQUNsRCxNQUFNQyxHQUFHLEdBQUcsTUFBTSxJQUFBQyxrQkFBTyxFQUFDdEIsTUFBTSxDQUFDdUIsR0FBRyxDQUFDLENBQ2xDQyxHQUFHLENBQUMsaUJBQWlCckIsV0FBVyxDQUFDWSxHQUFHLEVBQUUsQ0FBQyxDQUN2Q1UsTUFBTSxDQUFDLEdBQUcsQ0FBQztNQUVkQSxNQUFNLENBQUNKLEdBQUcsQ0FBQ0ssSUFBSSxDQUFDLENBQUNDLEVBQUUsQ0FBQ0MsSUFBSSxDQUFDQyxRQUFRLENBQUMsS0FBSyxFQUFFMUIsV0FBVyxDQUFDWSxHQUFHLENBQUNlLFFBQVEsQ0FBQyxDQUFDLENBQUM7TUFDcEVMLE1BQU0sQ0FBQ0osR0FBRyxDQUFDSyxJQUFJLENBQUMsQ0FBQ0MsRUFBRSxDQUFDQyxJQUFJLENBQUNDLFFBQVEsQ0FBQyxPQUFPLEVBQUUxQixXQUFXLENBQUM0QixLQUFLLENBQUM7SUFDL0QsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_mocha","require","_supertest","_interopRequireDefault","_mongoose","_testServer","_testHelpers","e","__esModule","default","server","testUser","authToken","testAuction","before","connectDB","clearDB","userData","createTestUser","testUserData","user","token","createTestServer","createTestAuction","seller","_id","after","stop","closeDB","describe","it","res","request","app","get","expect","body","to","have","property","toString","title"],"sourceRoot":"/Users/pizzosta/Desktop/CODING/auction-website/server/test/","sources":["auction.test.js"],"sourcesContent":["import { describe, it, before, after } from 'mocha';\nimport request from 'supertest';\nimport mongoose from 'mongoose';\nimport { createTestServer } from './testServer.js';\nimport { \n  connectDB, \n  closeDB, \n  clearDB, \n  createTestUser, \n  createTestAuction, \n  testUser as testUserData\n} from './testHelpers.js';\n\nlet server;\nlet testUser;\nlet authToken;\nlet testAuction;\n\n// Setup and teardown\nbefore(async () => {\n  await connectDB();\n  await clearDB();\n  \n  // Create a test user and get auth token\n  const userData = await createTestUser(testUserData);\n  testUser = userData.user;\n  authToken = userData.token;\n  \n  // Create and start the test server\n  server = await createTestServer();\n  \n  // Create a test auction\n  testAuction = await createTestAuction({ seller: testUser._id });\n});\n\nafter(async () => {\n  if (server) {\n    await server.stop();\n  }\n  await closeDB();\n});\n\ndescribe('Auction API', () => {\n  describe('GET /api/auctions/:id', () => {\n    it('should get a single auction by ID', async () => {\n      const res = await request(server.app)\n        .get(`/api/auctions/${testAuction._id}`)\n        .expect(200);\n      \n      expect(res.body).to.have.property('_id', testAuction._id.toString());\n      expect(res.body).to.have.property('title', testAuction.title);\n    });\n  });\n});\n"],"mappings":";;AAAA,IAAAA,MAAA,GAAAC,OAAA;AACA,IAAAC,UAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,SAAA,GAAAD,sBAAA,CAAAF,OAAA;AACA,IAAAI,WAAA,GAAAJ,OAAA;AACA,IAAAK,YAAA,GAAAL,OAAA;AAO0B,SAAAE,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1B,IAAIG,MAAM;AACV,IAAIC,QAAQ;AACZ,IAAIC,SAAS;AACb,IAAIC,WAAW;;AAEf;AACA,IAAAC,aAAM,EAAC,YAAY;EACjB,MAAM,IAAAC,sBAAS,EAAC,CAAC;EACjB,MAAM,IAAAC,oBAAO,EAAC,CAAC;;EAEf;EACA,MAAMC,QAAQ,GAAG,MAAM,IAAAC,2BAAc,EAACC,qBAAY,CAAC;EACnDR,QAAQ,GAAGM,QAAQ,CAACG,IAAI;EACxBR,SAAS,GAAGK,QAAQ,CAACI,KAAK;;EAE1B;EACAX,MAAM,GAAG,MAAM,IAAAY,4BAAgB,EAAC,CAAC;;EAEjC;EACAT,WAAW,GAAG,MAAM,IAAAU,8BAAiB,EAAC;IAAEC,MAAM,EAAEb,QAAQ,CAACc;EAAI,CAAC,CAAC;AACjE,CAAC,CAAC;AAEF,IAAAC,YAAK,EAAC,YAAY;EAChB,IAAIhB,MAAM,EAAE;IACV,MAAMA,MAAM,CAACiB,IAAI,CAAC,CAAC;EACrB;EACA,MAAM,IAAAC,oBAAO,EAAC,CAAC;AACjB,CAAC,CAAC;AAEF,IAAAC,eAAQ,EAAC,aAAa,EAAE,MAAM;EAC5B,IAAAA,eAAQ,EAAC,uBAAuB,EAAE,MAAM;IACtC,IAAAC,SAAE,EAAC,mCAAmC,EAAE,YAAY;MAClD,MAAMC,GAAG,GAAG,MAAM,IAAAC,kBAAO,EAACtB,MAAM,CAACuB,GAAG,CAAC,CAClCC,GAAG,CAAC,iBAAiBrB,WAAW,CAACY,GAAG,EAAE,CAAC,CACvCU,MAAM,CAAC,GAAG,CAAC;MAEdA,MAAM,CAACJ,GAAG,CAACK,IAAI,CAAC,CAACC,EAAE,CAACC,IAAI,CAACC,QAAQ,CAAC,KAAK,EAAE1B,WAAW,CAACY,GAAG,CAACe,QAAQ,CAAC,CAAC,CAAC;MACpEL,MAAM,CAACJ,GAAG,CAACK,IAAI,CAAC,CAACC,EAAE,CAACC,IAAI,CAACC,QAAQ,CAAC,OAAO,EAAE1B,WAAW,CAAC4B,KAAK,CAAC;IAC/D,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}},"mtime":1756649945609},"{\"assumptions\":{},\"sourceRoot\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/test/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"filename\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/test/testServer.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"test\",\"root\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-explicit-resource-management\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"BlockStatement\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.28.3:test":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createTestServer = void 0;\nvar _http = require(\"http\");\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _url = require(\"url\");\nvar _path = require(\"path\");\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\nvar _index = require(\"../src/middleware/index.js\");\nvar _index2 = require(\"../src/routes/index.js\");\nvar _errorHandler = require(\"../src/middleware/errorHandler.js\");\nvar _logger = _interopRequireDefault(require(\"../src/utils/logger.js\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Prevent the server from starting automatically in test mode\nprocess.env.NODE_ENV = 'test';\n\n// Create a new Express app for testing\nconst createTestApp = () => {\n  const app = (0, _express.default)();\n\n  // Setup middleware\n  (0, _index.setupMiddleware)(app);\n\n  // Setup routes\n  (0, _index2.setupRoutes)(app);\n\n  // Error handling middleware\n  app.use(_errorHandler.globalErrorHandler);\n  return app;\n};\nconst createTestServer = async () => {\n  const app = createTestApp();\n\n  // Create a new HTTP server instance\n  const httpServer = (0, _http.createServer)(app);\n\n  // Start the server on a random available port\n  await new Promise(resolve => {\n    httpServer.listen(0, () => resolve());\n  });\n  const address = httpServer.address();\n  const port = typeof address === 'string' ? 0 : address.port;\n\n  // Return an object with the server and a stop function\n  return {\n    server: httpServer,\n    app: app,\n    port: port,\n    stop: async () => {\n      return new Promise((resolve, reject) => {\n        if (!httpServer) return resolve();\n        httpServer.close(err => {\n          if (err) {\n            _logger.default.error('Error closing test server:', err);\n            reject(err);\n          } else {\n            _logger.default.info('Test server closed successfully');\n            resolve();\n          }\n        });\n      });\n    }\n  };\n};\nexports.createTestServer = createTestServer;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaHR0cCIsInJlcXVpcmUiLCJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfdXJsIiwiX3BhdGgiLCJfZG90ZW52IiwiX2luZGV4IiwiX2luZGV4MiIsIl9lcnJvckhhbmRsZXIiLCJfbG9nZ2VyIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiY3JlYXRlVGVzdEFwcCIsImFwcCIsImV4cHJlc3MiLCJzZXR1cE1pZGRsZXdhcmUiLCJzZXR1cFJvdXRlcyIsInVzZSIsImdsb2JhbEVycm9ySGFuZGxlciIsImNyZWF0ZVRlc3RTZXJ2ZXIiLCJodHRwU2VydmVyIiwiY3JlYXRlU2VydmVyIiwiUHJvbWlzZSIsInJlc29sdmUiLCJsaXN0ZW4iLCJhZGRyZXNzIiwicG9ydCIsInNlcnZlciIsInN0b3AiLCJyZWplY3QiLCJjbG9zZSIsImVyciIsImxvZ2dlciIsImVycm9yIiwiaW5mbyIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9waXp6b3N0YS9EZXNrdG9wL0NPRElORy9hdWN0aW9uLXdlYnNpdGUvc2VydmVyL3Rlc3QvIiwic291cmNlcyI6WyJ0ZXN0U2VydmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVNlcnZlciB9IGZyb20gJ2h0dHAnO1xuaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyBmaWxlVVJMVG9QYXRoIH0gZnJvbSAndXJsJztcbmltcG9ydCB7IGRpcm5hbWUsIGpvaW4gfSBmcm9tICdwYXRoJztcbmltcG9ydCBkb3RlbnYgZnJvbSAnZG90ZW52JztcbmltcG9ydCB7IHNldHVwTWlkZGxld2FyZSB9IGZyb20gJy4uL3NyYy9taWRkbGV3YXJlL2luZGV4LmpzJztcbmltcG9ydCB7IHNldHVwUm91dGVzIH0gZnJvbSAnLi4vc3JjL3JvdXRlcy9pbmRleC5qcyc7XG5pbXBvcnQgeyBnbG9iYWxFcnJvckhhbmRsZXIgfSBmcm9tICcuLi9zcmMvbWlkZGxld2FyZS9lcnJvckhhbmRsZXIuanMnO1xuaW1wb3J0IGxvZ2dlciBmcm9tICcuLi9zcmMvdXRpbHMvbG9nZ2VyLmpzJztcblxuLy8gUHJldmVudCB0aGUgc2VydmVyIGZyb20gc3RhcnRpbmcgYXV0b21hdGljYWxseSBpbiB0ZXN0IG1vZGVcbnByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ3Rlc3QnO1xuXG4vLyBDcmVhdGUgYSBuZXcgRXhwcmVzcyBhcHAgZm9yIHRlc3RpbmdcbmNvbnN0IGNyZWF0ZVRlc3RBcHAgPSAoKSA9PiB7XG4gIGNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcbiAgXG4gIC8vIFNldHVwIG1pZGRsZXdhcmVcbiAgc2V0dXBNaWRkbGV3YXJlKGFwcCk7XG4gIFxuICAvLyBTZXR1cCByb3V0ZXNcbiAgc2V0dXBSb3V0ZXMoYXBwKTtcbiAgXG4gIC8vIEVycm9yIGhhbmRsaW5nIG1pZGRsZXdhcmVcbiAgYXBwLnVzZShnbG9iYWxFcnJvckhhbmRsZXIpO1xuICBcbiAgcmV0dXJuIGFwcDtcbn07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVUZXN0U2VydmVyID0gYXN5bmMgKCkgPT4ge1xuICBjb25zdCBhcHAgPSBjcmVhdGVUZXN0QXBwKCk7XG4gIFxuICAvLyBDcmVhdGUgYSBuZXcgSFRUUCBzZXJ2ZXIgaW5zdGFuY2VcbiAgY29uc3QgaHR0cFNlcnZlciA9IGNyZWF0ZVNlcnZlcihhcHApO1xuICBcbiAgLy8gU3RhcnQgdGhlIHNlcnZlciBvbiBhIHJhbmRvbSBhdmFpbGFibGUgcG9ydFxuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIGh0dHBTZXJ2ZXIubGlzdGVuKDAsICgpID0+IHJlc29sdmUoKSk7XG4gIH0pO1xuICBcbiAgY29uc3QgYWRkcmVzcyA9IGh0dHBTZXJ2ZXIuYWRkcmVzcygpO1xuICBjb25zdCBwb3J0ID0gdHlwZW9mIGFkZHJlc3MgPT09ICdzdHJpbmcnID8gMCA6IGFkZHJlc3MucG9ydDtcbiAgXG4gIC8vIFJldHVybiBhbiBvYmplY3Qgd2l0aCB0aGUgc2VydmVyIGFuZCBhIHN0b3AgZnVuY3Rpb25cbiAgcmV0dXJuIHtcbiAgICBzZXJ2ZXI6IGh0dHBTZXJ2ZXIsXG4gICAgYXBwOiBhcHAsXG4gICAgcG9ydDogcG9ydCxcbiAgICBzdG9wOiBhc3luYyAoKSA9PiB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBpZiAoIWh0dHBTZXJ2ZXIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgIFxuICAgICAgICBodHRwU2VydmVyLmNsb3NlKChlcnIpID0+IHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGNsb3NpbmcgdGVzdCBzZXJ2ZXI6JywgZXJyKTtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2dnZXIuaW5mbygnVGVzdCBzZXJ2ZXIgY2xvc2VkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxLQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxRQUFBLEdBQUFDLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBRyxJQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxLQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxPQUFBLEdBQUFILHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBTSxNQUFBLEdBQUFOLE9BQUE7QUFDQSxJQUFBTyxPQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxhQUFBLEdBQUFSLE9BQUE7QUFDQSxJQUFBUyxPQUFBLEdBQUFQLHNCQUFBLENBQUFGLE9BQUE7QUFBNEMsU0FBQUUsdUJBQUFRLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFNUM7QUFDQUcsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFFBQVEsR0FBRyxNQUFNOztBQUU3QjtBQUNBLE1BQU1DLGFBQWEsR0FBR0EsQ0FBQSxLQUFNO0VBQzFCLE1BQU1DLEdBQUcsR0FBRyxJQUFBQyxnQkFBTyxFQUFDLENBQUM7O0VBRXJCO0VBQ0EsSUFBQUMsc0JBQWUsRUFBQ0YsR0FBRyxDQUFDOztFQUVwQjtFQUNBLElBQUFHLG1CQUFXLEVBQUNILEdBQUcsQ0FBQzs7RUFFaEI7RUFDQUEsR0FBRyxDQUFDSSxHQUFHLENBQUNDLGdDQUFrQixDQUFDO0VBRTNCLE9BQU9MLEdBQUc7QUFDWixDQUFDO0FBRU0sTUFBTU0sZ0JBQWdCLEdBQUcsTUFBQUEsQ0FBQSxLQUFZO0VBQzFDLE1BQU1OLEdBQUcsR0FBR0QsYUFBYSxDQUFDLENBQUM7O0VBRTNCO0VBQ0EsTUFBTVEsVUFBVSxHQUFHLElBQUFDLGtCQUFZLEVBQUNSLEdBQUcsQ0FBQzs7RUFFcEM7RUFDQSxNQUFNLElBQUlTLE9BQU8sQ0FBRUMsT0FBTyxJQUFLO0lBQzdCSCxVQUFVLENBQUNJLE1BQU0sQ0FBQyxDQUFDLEVBQUUsTUFBTUQsT0FBTyxDQUFDLENBQUMsQ0FBQztFQUN2QyxDQUFDLENBQUM7RUFFRixNQUFNRSxPQUFPLEdBQUdMLFVBQVUsQ0FBQ0ssT0FBTyxDQUFDLENBQUM7RUFDcEMsTUFBTUMsSUFBSSxHQUFHLE9BQU9ELE9BQU8sS0FBSyxRQUFRLEdBQUcsQ0FBQyxHQUFHQSxPQUFPLENBQUNDLElBQUk7O0VBRTNEO0VBQ0EsT0FBTztJQUNMQyxNQUFNLEVBQUVQLFVBQVU7SUFDbEJQLEdBQUcsRUFBRUEsR0FBRztJQUNSYSxJQUFJLEVBQUVBLElBQUk7SUFDVkUsSUFBSSxFQUFFLE1BQUFBLENBQUEsS0FBWTtNQUNoQixPQUFPLElBQUlOLE9BQU8sQ0FBQyxDQUFDQyxPQUFPLEVBQUVNLE1BQU0sS0FBSztRQUN0QyxJQUFJLENBQUNULFVBQVUsRUFBRSxPQUFPRyxPQUFPLENBQUMsQ0FBQztRQUVqQ0gsVUFBVSxDQUFDVSxLQUFLLENBQUVDLEdBQUcsSUFBSztVQUN4QixJQUFJQSxHQUFHLEVBQUU7WUFDUEMsZUFBTSxDQUFDQyxLQUFLLENBQUMsNEJBQTRCLEVBQUVGLEdBQUcsQ0FBQztZQUMvQ0YsTUFBTSxDQUFDRSxHQUFHLENBQUM7VUFDYixDQUFDLE1BQU07WUFDTEMsZUFBTSxDQUFDRSxJQUFJLENBQUMsaUNBQWlDLENBQUM7WUFDOUNYLE9BQU8sQ0FBQyxDQUFDO1VBQ1g7UUFDRixDQUFDLENBQUM7TUFDSixDQUFDLENBQUM7SUFDSjtFQUNGLENBQUM7QUFDSCxDQUFDO0FBQUNZLE9BQUEsQ0FBQWhCLGdCQUFBLEdBQUFBLGdCQUFBIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_http","require","_express","_interopRequireDefault","_url","_path","_dotenv","_index","_index2","_errorHandler","_logger","e","__esModule","default","process","env","NODE_ENV","createTestApp","app","express","setupMiddleware","setupRoutes","use","globalErrorHandler","createTestServer","httpServer","createServer","Promise","resolve","listen","address","port","server","stop","reject","close","err","logger","error","info","exports"],"sourceRoot":"/Users/pizzosta/Desktop/CODING/auction-website/server/test/","sources":["testServer.js"],"sourcesContent":["import { createServer } from 'http';\nimport express from 'express';\nimport { fileURLToPath } from 'url';\nimport { dirname, join } from 'path';\nimport dotenv from 'dotenv';\nimport { setupMiddleware } from '../src/middleware/index.js';\nimport { setupRoutes } from '../src/routes/index.js';\nimport { globalErrorHandler } from '../src/middleware/errorHandler.js';\nimport logger from '../src/utils/logger.js';\n\n// Prevent the server from starting automatically in test mode\nprocess.env.NODE_ENV = 'test';\n\n// Create a new Express app for testing\nconst createTestApp = () => {\n  const app = express();\n  \n  // Setup middleware\n  setupMiddleware(app);\n  \n  // Setup routes\n  setupRoutes(app);\n  \n  // Error handling middleware\n  app.use(globalErrorHandler);\n  \n  return app;\n};\n\nexport const createTestServer = async () => {\n  const app = createTestApp();\n  \n  // Create a new HTTP server instance\n  const httpServer = createServer(app);\n  \n  // Start the server on a random available port\n  await new Promise((resolve) => {\n    httpServer.listen(0, () => resolve());\n  });\n  \n  const address = httpServer.address();\n  const port = typeof address === 'string' ? 0 : address.port;\n  \n  // Return an object with the server and a stop function\n  return {\n    server: httpServer,\n    app: app,\n    port: port,\n    stop: async () => {\n      return new Promise((resolve, reject) => {\n        if (!httpServer) return resolve();\n        \n        httpServer.close((err) => {\n          if (err) {\n            logger.error('Error closing test server:', err);\n            reject(err);\n          } else {\n            logger.info('Test server closed successfully');\n            resolve();\n          }\n        });\n      });\n    }\n  };\n};\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,IAAA,GAAAH,OAAA;AACA,IAAAI,KAAA,GAAAJ,OAAA;AACA,IAAAK,OAAA,GAAAH,sBAAA,CAAAF,OAAA;AACA,IAAAM,MAAA,GAAAN,OAAA;AACA,IAAAO,OAAA,GAAAP,OAAA;AACA,IAAAQ,aAAA,GAAAR,OAAA;AACA,IAAAS,OAAA,GAAAP,sBAAA,CAAAF,OAAA;AAA4C,SAAAE,uBAAAQ,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE5C;AACAG,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAG,MAAM;;AAE7B;AACA,MAAMC,aAAa,GAAGA,CAAA,KAAM;EAC1B,MAAMC,GAAG,GAAG,IAAAC,gBAAO,EAAC,CAAC;;EAErB;EACA,IAAAC,sBAAe,EAACF,GAAG,CAAC;;EAEpB;EACA,IAAAG,mBAAW,EAACH,GAAG,CAAC;;EAEhB;EACAA,GAAG,CAACI,GAAG,CAACC,gCAAkB,CAAC;EAE3B,OAAOL,GAAG;AACZ,CAAC;AAEM,MAAMM,gBAAgB,GAAG,MAAAA,CAAA,KAAY;EAC1C,MAAMN,GAAG,GAAGD,aAAa,CAAC,CAAC;;EAE3B;EACA,MAAMQ,UAAU,GAAG,IAAAC,kBAAY,EAACR,GAAG,CAAC;;EAEpC;EACA,MAAM,IAAIS,OAAO,CAAEC,OAAO,IAAK;IAC7BH,UAAU,CAACI,MAAM,CAAC,CAAC,EAAE,MAAMD,OAAO,CAAC,CAAC,CAAC;EACvC,CAAC,CAAC;EAEF,MAAME,OAAO,GAAGL,UAAU,CAACK,OAAO,CAAC,CAAC;EACpC,MAAMC,IAAI,GAAG,OAAOD,OAAO,KAAK,QAAQ,GAAG,CAAC,GAAGA,OAAO,CAACC,IAAI;;EAE3D;EACA,OAAO;IACLC,MAAM,EAAEP,UAAU;IAClBP,GAAG,EAAEA,GAAG;IACRa,IAAI,EAAEA,IAAI;IACVE,IAAI,EAAE,MAAAA,CAAA,KAAY;MAChB,OAAO,IAAIN,OAAO,CAAC,CAACC,OAAO,EAAEM,MAAM,KAAK;QACtC,IAAI,CAACT,UAAU,EAAE,OAAOG,OAAO,CAAC,CAAC;QAEjCH,UAAU,CAACU,KAAK,CAAEC,GAAG,IAAK;UACxB,IAAIA,GAAG,EAAE;YACPC,eAAM,CAACC,KAAK,CAAC,4BAA4B,EAAEF,GAAG,CAAC;YAC/CF,MAAM,CAACE,GAAG,CAAC;UACb,CAAC,MAAM;YACLC,eAAM,CAACE,IAAI,CAAC,iCAAiC,CAAC;YAC9CX,OAAO,CAAC,CAAC;UACX;QACF,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ;EACF,CAAC;AACH,CAAC;AAACY,OAAA,CAAAhB,gBAAA,GAAAA,gBAAA","ignoreList":[]}},"mtime":1756650978511},"{\"assumptions\":{},\"sourceRoot\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/test/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"filename\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/test/testServer.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"test\",\"root\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-explicit-resource-management\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"BlockStatement\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.28.3:test":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createTestServer = void 0;\nvar _http = require(\"http\");\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _url = require(\"url\");\nvar _path = require(\"path\");\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\nvar _cors = _interopRequireDefault(require(\"cors\"));\nvar _helmet = _interopRequireDefault(require(\"helmet\"));\nvar _morgan = _interopRequireDefault(require(\"morgan\"));\nvar _expressRateLimit = require(\"express-rate-limit\");\nvar _expressMongoSanitize = _interopRequireDefault(require(\"express-mongo-sanitize\"));\nvar _xssClean = _interopRequireDefault(require(\"xss-clean\"));\nvar _hpp = _interopRequireDefault(require(\"hpp\"));\nvar _compression = _interopRequireDefault(require(\"compression\"));\nvar _cookieParser = _interopRequireDefault(require(\"cookie-parser\"));\nvar _errorHandler = require(\"../src/middleware/errorHandler.js\");\nvar _logger = _interopRequireDefault(require(\"../src/utils/logger.js\"));\nvar _authRoutes = _interopRequireDefault(require(\"../src/routes/authRoutes.js\"));\nvar _auctionRoutes = _interopRequireDefault(require(\"../src/routes/auctionRoutes.js\"));\nvar _bidRoutes = _interopRequireDefault(require(\"../src/routes/bidRoutes.js\"));\nvar _userRoutes = _interopRequireDefault(require(\"../src/routes/userRoutes.js\"));\nvar _categoryRoutes = _interopRequireDefault(require(\"../src/routes/categoryRoutes.js\"));\nvar _webhookRoutes = _interopRequireDefault(require(\"../src/routes/webhookRoutes.js\"));\nvar _requestContext = require(\"../src/middleware/requestContext.js\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Prevent the server from starting automatically in test mode\nprocess.env.NODE_ENV = 'test';\n\n// Create a new Express app for testing\nconst createTestApp = () => {\n  const app = (0, _express.default)();\n\n  // Set security HTTP headers\n  app.use((0, _helmet.default)());\n\n  // Development logging\n  if (process.env.NODE_ENV === 'development') {\n    app.use((0, _morgan.default)('dev'));\n  }\n\n  // Limit requests from same API\n  const limiter = (0, _expressRateLimit.rateLimit)({\n    max: 100,\n    windowMs: 60 * 60 * 1000,\n    message: 'Too many requests from this IP, please try again in an hour!'\n  });\n  app.use('/api', limiter);\n\n  // Body parser, reading data from body into req.body\n  app.use(_express.default.json({\n    limit: '10kb'\n  }));\n  app.use(_express.default.urlencoded({\n    extended: true,\n    limit: '10kb'\n  }));\n  app.use((0, _cookieParser.default)());\n\n  // Data sanitization against NoSQL query injection\n  app.use((0, _expressMongoSanitize.default)());\n\n  // Data sanitization against XSS\n  app.use((0, _xssClean.default)());\n\n  // Prevent parameter pollution\n  app.use((0, _hpp.default)({\n    whitelist: ['duration', 'ratingsQuantity', 'ratingsAverage', 'maxGroupSize', 'difficulty', 'price']\n  }));\n\n  // Serving static files\n  app.use(_express.default.static('public'));\n\n  // Test middleware\n  app.use((req, res, next) => {\n    req.requestTime = new Date().toISOString();\n    next();\n  });\n\n  // Request context middleware\n  app.use(_requestContext.requestContextMiddleware);\n\n  // Routes\n  app.use('/api/v1/auth', _authRoutes.default);\n  app.use('/api/v1/auctions', _auctionRoutes.default);\n  app.use('/api/v1/bids', _bidRoutes.default);\n  app.use('/api/v1/users', _userRoutes.default);\n  app.use('/api/v1/categories', _categoryRoutes.default);\n  app.use('/api/v1/webhooks', _webhookRoutes.default);\n\n  // Error handling middleware\n  app.use(_errorHandler.globalErrorHandler);\n  return app;\n};\nconst createTestServer = async () => {\n  const app = createTestApp();\n\n  // Create a new HTTP server instance\n  const httpServer = (0, _http.createServer)(app);\n\n  // Start the server on a random available port\n  await new Promise(resolve => {\n    httpServer.listen(0, () => resolve());\n  });\n  const address = httpServer.address();\n  const port = typeof address === 'string' ? 0 : address.port;\n\n  // Return an object with the server and a stop function\n  return {\n    server: httpServer,\n    app: app,\n    port: port,\n    stop: async () => {\n      return new Promise((resolve, reject) => {\n        if (!httpServer) return resolve();\n        httpServer.close(err => {\n          if (err) {\n            _logger.default.error('Error closing test server:', err);\n            reject(err);\n          } else {\n            _logger.default.info('Test server closed successfully');\n            resolve();\n          }\n        });\n      });\n    }\n  };\n};\nexports.createTestServer = createTestServer;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaHR0cCIsInJlcXVpcmUiLCJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfdXJsIiwiX3BhdGgiLCJfZG90ZW52IiwiX2NvcnMiLCJfaGVsbWV0IiwiX21vcmdhbiIsIl9leHByZXNzUmF0ZUxpbWl0IiwiX2V4cHJlc3NNb25nb1Nhbml0aXplIiwiX3hzc0NsZWFuIiwiX2hwcCIsIl9jb21wcmVzc2lvbiIsIl9jb29raWVQYXJzZXIiLCJfZXJyb3JIYW5kbGVyIiwiX2xvZ2dlciIsIl9hdXRoUm91dGVzIiwiX2F1Y3Rpb25Sb3V0ZXMiLCJfYmlkUm91dGVzIiwiX3VzZXJSb3V0ZXMiLCJfY2F0ZWdvcnlSb3V0ZXMiLCJfd2ViaG9va1JvdXRlcyIsIl9yZXF1ZXN0Q29udGV4dCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImNyZWF0ZVRlc3RBcHAiLCJhcHAiLCJleHByZXNzIiwidXNlIiwiaGVsbWV0IiwibW9yZ2FuIiwibGltaXRlciIsInJhdGVMaW1pdCIsIm1heCIsIndpbmRvd01zIiwibWVzc2FnZSIsImpzb24iLCJsaW1pdCIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsImNvb2tpZVBhcnNlciIsIm1vbmdvU2FuaXRpemUiLCJ4c3MiLCJocHAiLCJ3aGl0ZWxpc3QiLCJzdGF0aWMiLCJyZXEiLCJyZXMiLCJuZXh0IiwicmVxdWVzdFRpbWUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJyZXF1ZXN0Q29udGV4dE1pZGRsZXdhcmUiLCJhdXRoUm91dGVzIiwiYXVjdGlvblJvdXRlcyIsImJpZFJvdXRlcyIsInVzZXJSb3V0ZXMiLCJjYXRlZ29yeVJvdXRlcyIsIndlYmhvb2tSb3V0ZXMiLCJnbG9iYWxFcnJvckhhbmRsZXIiLCJjcmVhdGVUZXN0U2VydmVyIiwiaHR0cFNlcnZlciIsImNyZWF0ZVNlcnZlciIsIlByb21pc2UiLCJyZXNvbHZlIiwibGlzdGVuIiwiYWRkcmVzcyIsInBvcnQiLCJzZXJ2ZXIiLCJzdG9wIiwicmVqZWN0IiwiY2xvc2UiLCJlcnIiLCJsb2dnZXIiLCJlcnJvciIsImluZm8iLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcGl6em9zdGEvRGVza3RvcC9DT0RJTkcvYXVjdGlvbi13ZWJzaXRlL3NlcnZlci90ZXN0LyIsInNvdXJjZXMiOlsidGVzdFNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVTZXJ2ZXIgfSBmcm9tICdodHRwJztcbmltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgZmlsZVVSTFRvUGF0aCB9IGZyb20gJ3VybCc7XG5pbXBvcnQgeyBkaXJuYW1lLCBqb2luIH0gZnJvbSAncGF0aCc7XG5pbXBvcnQgZG90ZW52IGZyb20gJ2RvdGVudic7XG5pbXBvcnQgY29ycyBmcm9tICdjb3JzJztcbmltcG9ydCBoZWxtZXQgZnJvbSAnaGVsbWV0JztcbmltcG9ydCBtb3JnYW4gZnJvbSAnbW9yZ2FuJztcbmltcG9ydCB7IHJhdGVMaW1pdCB9IGZyb20gJ2V4cHJlc3MtcmF0ZS1saW1pdCc7XG5pbXBvcnQgbW9uZ29TYW5pdGl6ZSBmcm9tICdleHByZXNzLW1vbmdvLXNhbml0aXplJztcbmltcG9ydCB4c3MgZnJvbSAneHNzLWNsZWFuJztcbmltcG9ydCBocHAgZnJvbSAnaHBwJztcbmltcG9ydCBjb21wcmVzc2lvbiBmcm9tICdjb21wcmVzc2lvbic7XG5pbXBvcnQgY29va2llUGFyc2VyIGZyb20gJ2Nvb2tpZS1wYXJzZXInO1xuaW1wb3J0IHsgZ2xvYmFsRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi4vc3JjL21pZGRsZXdhcmUvZXJyb3JIYW5kbGVyLmpzJztcbmltcG9ydCBsb2dnZXIgZnJvbSAnLi4vc3JjL3V0aWxzL2xvZ2dlci5qcyc7XG5pbXBvcnQgYXV0aFJvdXRlcyBmcm9tICcuLi9zcmMvcm91dGVzL2F1dGhSb3V0ZXMuanMnO1xuaW1wb3J0IGF1Y3Rpb25Sb3V0ZXMgZnJvbSAnLi4vc3JjL3JvdXRlcy9hdWN0aW9uUm91dGVzLmpzJztcbmltcG9ydCBiaWRSb3V0ZXMgZnJvbSAnLi4vc3JjL3JvdXRlcy9iaWRSb3V0ZXMuanMnO1xuaW1wb3J0IHVzZXJSb3V0ZXMgZnJvbSAnLi4vc3JjL3JvdXRlcy91c2VyUm91dGVzLmpzJztcbmltcG9ydCBjYXRlZ29yeVJvdXRlcyBmcm9tICcuLi9zcmMvcm91dGVzL2NhdGVnb3J5Um91dGVzLmpzJztcbmltcG9ydCB3ZWJob29rUm91dGVzIGZyb20gJy4uL3NyYy9yb3V0ZXMvd2ViaG9va1JvdXRlcy5qcyc7XG5pbXBvcnQgeyByZXF1ZXN0Q29udGV4dE1pZGRsZXdhcmUgfSBmcm9tICcuLi9zcmMvbWlkZGxld2FyZS9yZXF1ZXN0Q29udGV4dC5qcyc7XG5pbXBvcnQgeyBlcnJvckhhbmRsZXIgYXMgZXJyb3JNaWRkbGV3YXJlIH0gZnJvbSAnLi4vc3JjL21pZGRsZXdhcmUvZXJyb3JIYW5kbGVyLmpzJztcblxuLy8gUHJldmVudCB0aGUgc2VydmVyIGZyb20gc3RhcnRpbmcgYXV0b21hdGljYWxseSBpbiB0ZXN0IG1vZGVcbnByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ3Rlc3QnO1xuXG4vLyBDcmVhdGUgYSBuZXcgRXhwcmVzcyBhcHAgZm9yIHRlc3RpbmdcbmNvbnN0IGNyZWF0ZVRlc3RBcHAgPSAoKSA9PiB7XG4gIGNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcbiAgXG4gIC8vIFNldCBzZWN1cml0eSBIVFRQIGhlYWRlcnNcbiAgYXBwLnVzZShoZWxtZXQoKSk7XG4gIFxuICAvLyBEZXZlbG9wbWVudCBsb2dnaW5nXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgIGFwcC51c2UobW9yZ2FuKCdkZXYnKSk7XG4gIH1cbiAgXG4gIC8vIExpbWl0IHJlcXVlc3RzIGZyb20gc2FtZSBBUElcbiAgY29uc3QgbGltaXRlciA9IHJhdGVMaW1pdCh7XG4gICAgbWF4OiAxMDAsXG4gICAgd2luZG93TXM6IDYwICogNjAgKiAxMDAwLFxuICAgIG1lc3NhZ2U6ICdUb28gbWFueSByZXF1ZXN0cyBmcm9tIHRoaXMgSVAsIHBsZWFzZSB0cnkgYWdhaW4gaW4gYW4gaG91ciEnXG4gIH0pO1xuICBcbiAgYXBwLnVzZSgnL2FwaScsIGxpbWl0ZXIpO1xuICBcbiAgLy8gQm9keSBwYXJzZXIsIHJlYWRpbmcgZGF0YSBmcm9tIGJvZHkgaW50byByZXEuYm9keVxuICBhcHAudXNlKGV4cHJlc3MuanNvbih7IGxpbWl0OiAnMTBrYicgfSkpO1xuICBhcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlLCBsaW1pdDogJzEwa2InIH0pKTtcbiAgYXBwLnVzZShjb29raWVQYXJzZXIoKSk7XG4gIFxuICAvLyBEYXRhIHNhbml0aXphdGlvbiBhZ2FpbnN0IE5vU1FMIHF1ZXJ5IGluamVjdGlvblxuICBhcHAudXNlKG1vbmdvU2FuaXRpemUoKSk7XG4gIFxuICAvLyBEYXRhIHNhbml0aXphdGlvbiBhZ2FpbnN0IFhTU1xuICBhcHAudXNlKHhzcygpKTtcbiAgXG4gIC8vIFByZXZlbnQgcGFyYW1ldGVyIHBvbGx1dGlvblxuICBhcHAudXNlKGhwcCh7XG4gICAgd2hpdGVsaXN0OiBbXG4gICAgICAnZHVyYXRpb24nLCAncmF0aW5nc1F1YW50aXR5JywgJ3JhdGluZ3NBdmVyYWdlJywgJ21heEdyb3VwU2l6ZScsICdkaWZmaWN1bHR5JywgJ3ByaWNlJ1xuICAgIF1cbiAgfSkpO1xuICBcbiAgLy8gU2VydmluZyBzdGF0aWMgZmlsZXNcbiAgYXBwLnVzZShleHByZXNzLnN0YXRpYygncHVibGljJykpO1xuICBcbiAgLy8gVGVzdCBtaWRkbGV3YXJlXG4gIGFwcC51c2UoKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgcmVxLnJlcXVlc3RUaW1lID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIG5leHQoKTtcbiAgfSk7XG4gIFxuICAvLyBSZXF1ZXN0IGNvbnRleHQgbWlkZGxld2FyZVxuICBhcHAudXNlKHJlcXVlc3RDb250ZXh0TWlkZGxld2FyZSk7XG4gIFxuICAvLyBSb3V0ZXNcbiAgYXBwLnVzZSgnL2FwaS92MS9hdXRoJywgYXV0aFJvdXRlcyk7XG4gIGFwcC51c2UoJy9hcGkvdjEvYXVjdGlvbnMnLCBhdWN0aW9uUm91dGVzKTtcbiAgYXBwLnVzZSgnL2FwaS92MS9iaWRzJywgYmlkUm91dGVzKTtcbiAgYXBwLnVzZSgnL2FwaS92MS91c2VycycsIHVzZXJSb3V0ZXMpO1xuICBhcHAudXNlKCcvYXBpL3YxL2NhdGVnb3JpZXMnLCBjYXRlZ29yeVJvdXRlcyk7XG4gIGFwcC51c2UoJy9hcGkvdjEvd2ViaG9va3MnLCB3ZWJob29rUm91dGVzKTtcbiAgXG4gIC8vIEVycm9yIGhhbmRsaW5nIG1pZGRsZXdhcmVcbiAgYXBwLnVzZShnbG9iYWxFcnJvckhhbmRsZXIpO1xuICBcbiAgcmV0dXJuIGFwcDtcbn07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVUZXN0U2VydmVyID0gYXN5bmMgKCkgPT4ge1xuICBjb25zdCBhcHAgPSBjcmVhdGVUZXN0QXBwKCk7XG4gIFxuICAvLyBDcmVhdGUgYSBuZXcgSFRUUCBzZXJ2ZXIgaW5zdGFuY2VcbiAgY29uc3QgaHR0cFNlcnZlciA9IGNyZWF0ZVNlcnZlcihhcHApO1xuICBcbiAgLy8gU3RhcnQgdGhlIHNlcnZlciBvbiBhIHJhbmRvbSBhdmFpbGFibGUgcG9ydFxuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIGh0dHBTZXJ2ZXIubGlzdGVuKDAsICgpID0+IHJlc29sdmUoKSk7XG4gIH0pO1xuICBcbiAgY29uc3QgYWRkcmVzcyA9IGh0dHBTZXJ2ZXIuYWRkcmVzcygpO1xuICBjb25zdCBwb3J0ID0gdHlwZW9mIGFkZHJlc3MgPT09ICdzdHJpbmcnID8gMCA6IGFkZHJlc3MucG9ydDtcbiAgXG4gIC8vIFJldHVybiBhbiBvYmplY3Qgd2l0aCB0aGUgc2VydmVyIGFuZCBhIHN0b3AgZnVuY3Rpb25cbiAgcmV0dXJuIHtcbiAgICBzZXJ2ZXI6IGh0dHBTZXJ2ZXIsXG4gICAgYXBwOiBhcHAsXG4gICAgcG9ydDogcG9ydCxcbiAgICBzdG9wOiBhc3luYyAoKSA9PiB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBpZiAoIWh0dHBTZXJ2ZXIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgIFxuICAgICAgICBodHRwU2VydmVyLmNsb3NlKChlcnIpID0+IHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGNsb3NpbmcgdGVzdCBzZXJ2ZXI6JywgZXJyKTtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2dnZXIuaW5mbygnVGVzdCBzZXJ2ZXIgY2xvc2VkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxLQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxRQUFBLEdBQUFDLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBRyxJQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxLQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxPQUFBLEdBQUFILHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBTSxLQUFBLEdBQUFKLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBTyxPQUFBLEdBQUFMLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBUSxPQUFBLEdBQUFOLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBUyxpQkFBQSxHQUFBVCxPQUFBO0FBQ0EsSUFBQVUscUJBQUEsR0FBQVIsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFXLFNBQUEsR0FBQVQsc0JBQUEsQ0FBQUYsT0FBQTtBQUNB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","map":{"version":3,"names":["_http","require","_express","_interopRequireDefault","_url","_path","_dotenv","_cors","_helmet","_morgan","_expressRateLimit","_expressMongoSanitize","_xssClean","_hpp","_compression","_cookieParser","_errorHandler","_logger","_authRoutes","_auctionRoutes","_bidRoutes","_userRoutes","_categoryRoutes","_webhookRoutes","_requestContext","e","__esModule","default","process","env","NODE_ENV","createTestApp","app","express","use","helmet","morgan","limiter","rateLimit","max","windowMs","message","json","limit","urlencoded","extended","cookieParser","mongoSanitize","xss","hpp","whitelist","static","req","res","next","requestTime","Date","toISOString","requestContextMiddleware","authRoutes","auctionRoutes","bidRoutes","userRoutes","categoryRoutes","webhookRoutes","globalErrorHandler","createTestServer","httpServer","createServer","Promise","resolve","listen","address","port","server","stop","reject","close","err","logger","error","info","exports"],"sourceRoot":"/Users/pizzosta/Desktop/CODING/auction-website/server/test/","sources":["testServer.js"],"sourcesContent":["import { createServer } from 'http';\nimport express from 'express';\nimport { fileURLToPath } from 'url';\nimport { dirname, join } from 'path';\nimport dotenv from 'dotenv';\nimport cors from 'cors';\nimport helmet from 'helmet';\nimport morgan from 'morgan';\nimport { rateLimit } from 'express-rate-limit';\nimport mongoSanitize from 'express-mongo-sanitize';\nimport xss from 'xss-clean';\nimport hpp from 'hpp';\nimport compression from 'compression';\nimport cookieParser from 'cookie-parser';\nimport { globalErrorHandler } from '../src/middleware/errorHandler.js';\nimport logger from '../src/utils/logger.js';\nimport authRoutes from '../src/routes/authRoutes.js';\nimport auctionRoutes from '../src/routes/auctionRoutes.js';\nimport bidRoutes from '../src/routes/bidRoutes.js';\nimport userRoutes from '../src/routes/userRoutes.js';\nimport categoryRoutes from '../src/routes/categoryRoutes.js';\nimport webhookRoutes from '../src/routes/webhookRoutes.js';\nimport { requestContextMiddleware } from '../src/middleware/requestContext.js';\nimport { errorHandler as errorMiddleware } from '../src/middleware/errorHandler.js';\n\n// Prevent the server from starting automatically in test mode\nprocess.env.NODE_ENV = 'test';\n\n// Create a new Express app for testing\nconst createTestApp = () => {\n  const app = express();\n  \n  // Set security HTTP headers\n  app.use(helmet());\n  \n  // Development logging\n  if (process.env.NODE_ENV === 'development') {\n    app.use(morgan('dev'));\n  }\n  \n  // Limit requests from same API\n  const limiter = rateLimit({\n    max: 100,\n    windowMs: 60 * 60 * 1000,\n    message: 'Too many requests from this IP, please try again in an hour!'\n  });\n  \n  app.use('/api', limiter);\n  \n  // Body parser, reading data from body into req.body\n  app.use(express.json({ limit: '10kb' }));\n  app.use(express.urlencoded({ extended: true, limit: '10kb' }));\n  app.use(cookieParser());\n  \n  // Data sanitization against NoSQL query injection\n  app.use(mongoSanitize());\n  \n  // Data sanitization against XSS\n  app.use(xss());\n  \n  // Prevent parameter pollution\n  app.use(hpp({\n    whitelist: [\n      'duration', 'ratingsQuantity', 'ratingsAverage', 'maxGroupSize', 'difficulty', 'price'\n    ]\n  }));\n  \n  // Serving static files\n  app.use(express.static('public'));\n  \n  // Test middleware\n  app.use((req, res, next) => {\n    req.requestTime = new Date().toISOString();\n    next();\n  });\n  \n  // Request context middleware\n  app.use(requestContextMiddleware);\n  \n  // Routes\n  app.use('/api/v1/auth', authRoutes);\n  app.use('/api/v1/auctions', auctionRoutes);\n  app.use('/api/v1/bids', bidRoutes);\n  app.use('/api/v1/users', userRoutes);\n  app.use('/api/v1/categories', categoryRoutes);\n  app.use('/api/v1/webhooks', webhookRoutes);\n  \n  // Error handling middleware\n  app.use(globalErrorHandler);\n  \n  return app;\n};\n\nexport const createTestServer = async () => {\n  const app = createTestApp();\n  \n  // Create a new HTTP server instance\n  const httpServer = createServer(app);\n  \n  // Start the server on a random available port\n  await new Promise((resolve) => {\n    httpServer.listen(0, () => resolve());\n  });\n  \n  const address = httpServer.address();\n  const port = typeof address === 'string' ? 0 : address.port;\n  \n  // Return an object with the server and a stop function\n  return {\n    server: httpServer,\n    app: app,\n    port: port,\n    stop: async () => {\n      return new Promise((resolve, reject) => {\n        if (!httpServer) return resolve();\n        \n        httpServer.close((err) => {\n          if (err) {\n            logger.error('Error closing test server:', err);\n            reject(err);\n          } else {\n            logger.info('Test server closed successfully');\n            resolve();\n          }\n        });\n      });\n    }\n  };\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1756651257111},"{\"assumptions\":{},\"sourceRoot\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/src/middleware/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"filename\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/src/middleware/errorHandler.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"test\",\"root\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-explicit-resource-management\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"BlockStatement\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.28.3:test":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.globalErrorHandler = exports.AppError = void 0;\nvar _logger = _interopRequireDefault(require(\"../utils/logger.js\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n/**\n * Custom error class for handling operational errors\n */\nclass AppError extends Error {\n  constructor(message, statusCode) {\n    super(message);\n    this.statusCode = statusCode;\n    this.status = `${statusCode}`.startsWith('4') ? 'fail' : 'error';\n    this.isOperational = true;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\n/**\n * Error handlers for specific error types\n */\nexports.AppError = AppError;\nconst handleCastErrorDB = err => {\n  const message = `Invalid ${err.path}: ${err.value}`;\n  return new AppError(message, 400);\n};\nconst handleDuplicateFieldsDB = err => {\n  // Extract the duplicate field key and value\n  const fieldName = Object.keys(err.keyPattern || {})[0] || 'field';\n  const fieldValue = err.keyValue ? err.keyValue[fieldName] : 'unknown';\n  let message;\n  switch (fieldName) {\n    case 'email':\n      message = 'An account with this email already exists.';\n      break;\n    case 'username':\n      message = 'This username is already taken.';\n      break;\n    case 'phone':\n      message = 'This phone number is already registered.';\n      break;\n    default:\n      message = `Duplicate value for ${fieldName}: \"${fieldValue}\". Please use another value!`;\n  }\n  return new AppError(message, 400);\n};\nconst handleValidationErrorDB = err => {\n  const errors = Object.values(err.errors).map(el => el.message);\n  const message = `Invalid input data. ${errors.join('. ')}`;\n  return new AppError(message, 400);\n};\nconst handleJWTError = () => new AppError('Invalid token. Please log in again!', 401);\nconst handleJWTExpiredError = () => new AppError('Your token has expired! Please log in again.', 401);\n\n/**\n * Global error handling middleware\n */\nconst globalErrorHandler = (err, req, res, _next) => {\n  err.statusCode = err.statusCode || 500;\n  err.status = err.status || 'error';\n\n  // Normalize the error object\n  let error = {\n    ...err\n  };\n  error.message = err.message;\n  error.stack = err.stack;\n\n  // Handle specific error types\n  if (error.name === 'CastError') error = handleCastErrorDB(error);\n  if (error.code === 11000) error = handleDuplicateFieldsDB(error);\n  if (error.name === 'ValidationError') error = handleValidationErrorDB(error);\n  if (error.name === 'JsonWebTokenError') error = handleJWTError();\n  if (error.name === 'TokenExpiredError') error = handleJWTExpiredError();\n\n  // Determine log level based on error type\n  const logLevel = error.isOperational ? 'warn' : 'error';\n\n  // Log structured error with request context\n  _logger.default[logLevel]('Unhandled error', {\n    status: error.status,\n    statusCode: error.statusCode,\n    message: error.message,\n    stack: error.stack,\n    path: req.originalUrl,\n    method: req.method,\n    ip: req.ip,\n    isOperational: error.isOperational,\n    // Only include stack for non-operational errors in production\n    ...(!error.isOperational && {\n      stack: error.stack\n    }),\n    // Include original error object for debugging in development\n    ...(process.env.NODE_ENV === 'development' && {\n      stack: error.stack,\n      originalError: {\n        name: err.name,\n        message: err.message,\n        code: err.code,\n        full: err\n      }\n    })\n  });\n\n  // Send response to client\n  res.status(error.statusCode || 500).json({\n    status: error.status,\n    message: error.message || 'Something went wrong!',\n    ...(process.env.NODE_ENV === 'development' && {\n      stack: error.stack\n    })\n  });\n};\nexports.globalErrorHandler = globalErrorHandler;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbG9nZ2VyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJBcHBFcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJtZXNzYWdlIiwic3RhdHVzQ29kZSIsInN0YXR1cyIsInN0YXJ0c1dpdGgiLCJpc09wZXJhdGlvbmFsIiwiY2FwdHVyZVN0YWNrVHJhY2UiLCJleHBvcnRzIiwiaGFuZGxlQ2FzdEVycm9yREIiLCJlcnIiLCJwYXRoIiwidmFsdWUiLCJoYW5kbGVEdXBsaWNhdGVGaWVsZHNEQiIsImZpZWxkTmFtZSIsIk9iamVjdCIsImtleXMiLCJrZXlQYXR0ZXJuIiwiZmllbGRWYWx1ZSIsImtleVZhbHVlIiwiaGFuZGxlVmFsaWRhdGlvbkVycm9yREIiLCJlcnJvcnMiLCJ2YWx1ZXMiLCJtYXAiLCJlbCIsImpvaW4iLCJoYW5kbGVKV1RFcnJvciIsImhhbmRsZUpXVEV4cGlyZWRFcnJvciIsImdsb2JhbEVycm9ySGFuZGxlciIsInJlcSIsInJlcyIsIl9uZXh0IiwiZXJyb3IiLCJzdGFjayIsIm5hbWUiLCJjb2RlIiwibG9nTGV2ZWwiLCJsb2dnZXIiLCJvcmlnaW5hbFVybCIsIm1ldGhvZCIsImlwIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwib3JpZ2luYWxFcnJvciIsImZ1bGwiLCJqc29uIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcGl6em9zdGEvRGVza3RvcC9DT0RJTkcvYXVjdGlvbi13ZWJzaXRlL3NlcnZlci9zcmMvbWlkZGxld2FyZS8iLCJzb3VyY2VzIjpbImVycm9ySGFuZGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbG9nZ2VyIGZyb20gJy4uL3V0aWxzL2xvZ2dlci5qcyc7XG5cbi8qKlxuICogQ3VzdG9tIGVycm9yIGNsYXNzIGZvciBoYW5kbGluZyBvcGVyYXRpb25hbCBlcnJvcnNcbiAqL1xuY2xhc3MgQXBwRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIHN0YXR1c0NvZGUpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICAgIHRoaXMuc3RhdHVzID0gYCR7c3RhdHVzQ29kZX1gLnN0YXJ0c1dpdGgoJzQnKSA/ICdmYWlsJyA6ICdlcnJvcic7XG4gICAgdGhpcy5pc09wZXJhdGlvbmFsID0gdHJ1ZTtcbiAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgfVxufVxuXG4vKipcbiAqIEVycm9yIGhhbmRsZXJzIGZvciBzcGVjaWZpYyBlcnJvciB0eXBlc1xuICovXG5jb25zdCBoYW5kbGVDYXN0RXJyb3JEQiA9IGVyciA9PiB7XG4gIGNvbnN0IG1lc3NhZ2UgPSBgSW52YWxpZCAke2Vyci5wYXRofTogJHtlcnIudmFsdWV9YDtcbiAgcmV0dXJuIG5ldyBBcHBFcnJvcihtZXNzYWdlLCA0MDApO1xufTtcblxuY29uc3QgaGFuZGxlRHVwbGljYXRlRmllbGRzREIgPSBlcnIgPT4ge1xuICAvLyBFeHRyYWN0IHRoZSBkdXBsaWNhdGUgZmllbGQga2V5IGFuZCB2YWx1ZVxuICBjb25zdCBmaWVsZE5hbWUgPSBPYmplY3Qua2V5cyhlcnIua2V5UGF0dGVybiB8fCB7fSlbMF0gfHwgJ2ZpZWxkJztcbiAgY29uc3QgZmllbGRWYWx1ZSA9IGVyci5rZXlWYWx1ZSA/IGVyci5rZXlWYWx1ZVtmaWVsZE5hbWVdIDogJ3Vua25vd24nO1xuXG4gIGxldCBtZXNzYWdlO1xuICBzd2l0Y2ggKGZpZWxkTmFtZSkge1xuICAgIGNhc2UgJ2VtYWlsJzpcbiAgICAgIG1lc3NhZ2UgPSAnQW4gYWNjb3VudCB3aXRoIHRoaXMgZW1haWwgYWxyZWFkeSBleGlzdHMuJztcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3VzZXJuYW1lJzpcbiAgICAgIG1lc3NhZ2UgPSAnVGhpcyB1c2VybmFtZSBpcyBhbHJlYWR5IHRha2VuLic7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdwaG9uZSc6XG4gICAgICBtZXNzYWdlID0gJ1RoaXMgcGhvbmUgbnVtYmVyIGlzIGFscmVhZHkgcmVnaXN0ZXJlZC4nO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIG1lc3NhZ2UgPSBgRHVwbGljYXRlIHZhbHVlIGZvciAke2ZpZWxkTmFtZX06IFwiJHtmaWVsZFZhbHVlfVwiLiBQbGVhc2UgdXNlIGFub3RoZXIgdmFsdWUhYDtcbiAgfVxuXG4gIHJldHVybiBuZXcgQXBwRXJyb3IobWVzc2FnZSwgNDAwKTtcbn07XG5cbmNvbnN0IGhhbmRsZVZhbGlkYXRpb25FcnJvckRCID0gZXJyID0+IHtcbiAgY29uc3QgZXJyb3JzID0gT2JqZWN0LnZhbHVlcyhlcnIuZXJyb3JzKS5tYXAoZWwgPT4gZWwubWVzc2FnZSk7XG4gIGNvbnN0IG1lc3NhZ2UgPSBgSW52YWxpZCBpbnB1dCBkYXRhLiAke2Vycm9ycy5qb2luKCcuICcpfWA7XG4gIHJldHVybiBuZXcgQXBwRXJyb3IobWVzc2FnZSwgNDAwKTtcbn07XG5cbmNvbnN0IGhhbmRsZUpXVEVycm9yID0gKCkgPT4gbmV3IEFwcEVycm9yKCdJbnZhbGlkIHRva2VuLiBQbGVhc2UgbG9nIGluIGFnYWluIScsIDQwMSk7XG5cbmNvbnN0IGhhbmRsZUpXVEV4cGlyZWRFcnJvciA9ICgpID0+XG4gIG5ldyBBcHBFcnJvcignWW91ciB0b2tlbiBoYXMgZXhwaXJlZCEgUGxlYXNlIGxvZyBpbiBhZ2Fpbi4nLCA0MDEpO1xuXG4vKipcbiAqIEdsb2JhbCBlcnJvciBoYW5kbGluZyBtaWRkbGV3YXJlXG4gKi9cbmNvbnN0IGdsb2JhbEVycm9ySGFuZGxlciA9IChlcnIsIHJlcSwgcmVzLCBfbmV4dCkgPT4ge1xuICBlcnIuc3RhdHVzQ29kZSA9IGVyci5zdGF0dXNDb2RlIHx8IDUwMDtcbiAgZXJyLnN0YXR1cyA9IGVyci5zdGF0dXMgfHwgJ2Vycm9yJztcblxuICAvLyBOb3JtYWxpemUgdGhlIGVycm9yIG9iamVjdFxuICBsZXQgZXJyb3IgPSB7IC4uLmVyciB9O1xuICBlcnJvci5tZXNzYWdlID0gZXJyLm1lc3NhZ2U7XG4gIGVycm9yLnN0YWNrID0gZXJyLnN0YWNrO1xuXG4gIC8vIEhhbmRsZSBzcGVjaWZpYyBlcnJvciB0eXBlc1xuICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Nhc3RFcnJvcicpIGVycm9yID0gaGFuZGxlQ2FzdEVycm9yREIoZXJyb3IpO1xuICBpZiAoZXJyb3IuY29kZSA9PT0gMTEwMDApIGVycm9yID0gaGFuZGxlRHVwbGljYXRlRmllbGRzREIoZXJyb3IpO1xuICBpZiAoZXJyb3IubmFtZSA9PT0gJ1ZhbGlkYXRpb25FcnJvcicpIGVycm9yID0gaGFuZGxlVmFsaWRhdGlvbkVycm9yREIoZXJyb3IpO1xuICBpZiAoZXJyb3IubmFtZSA9PT0gJ0pzb25XZWJUb2tlbkVycm9yJykgZXJyb3IgPSBoYW5kbGVKV1RFcnJvcigpO1xuICBpZiAoZXJyb3IubmFtZSA9PT0gJ1Rva2VuRXhwaXJlZEVycm9yJykgZXJyb3IgPSBoYW5kbGVKV1RFeHBpcmVkRXJyb3IoKTtcblxuICAvLyBEZXRlcm1pbmUgbG9nIGxldmVsIGJhc2VkIG9uIGVycm9yIHR5cGVcbiAgY29uc3QgbG9nTGV2ZWwgPSBlcnJvci5pc09wZXJhdGlvbmFsID8gJ3dhcm4nIDogJ2Vycm9yJztcblxuICAvLyBMb2cgc3RydWN0dXJlZCBlcnJvciB3aXRoIHJlcXVlc3QgY29udGV4dFxuICBsb2dnZXJbbG9nTGV2ZWxdKCdVbmhhbmRsZWQgZXJyb3InLCB7XG4gICAgc3RhdHVzOiBlcnJvci5zdGF0dXMsXG4gICAgc3RhdHVzQ29kZTogZXJyb3Iuc3RhdHVzQ29kZSxcbiAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgIHN0YWNrOiBlcnJvci5zdGFjayxcbiAgICBwYXRoOiByZXEub3JpZ2luYWxVcmwsXG4gICAgbWV0aG9kOiByZXEubWV0aG9kLFxuICAgIGlwOiByZXEuaXAsXG4gICAgaXNPcGVyYXRpb25hbDogZXJyb3IuaXNPcGVyYXRpb25hbCxcbiAgICAvLyBPbmx5IGluY2x1ZGUgc3RhY2sgZm9yIG5vbi1vcGVyYXRpb25hbCBlcnJvcnMgaW4gcHJvZHVjdGlvblxuICAgIC4uLighZXJyb3IuaXNPcGVyYXRpb25hbCAmJiB7IHN0YWNrOiBlcnJvci5zdGFjayB9KSxcbiAgICAvLyBJbmNsdWRlIG9yaWdpbmFsIGVycm9yIG9iamVjdCBmb3IgZGVidWdnaW5nIGluIGRldmVsb3BtZW50XG4gICAgLi4uKFxuICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCdcbiAgICAgICYmIHtcbiAgICAgICAgc3RhY2s6IGVycm9yLnN0YWNrLFxuICAgICAgICBvcmlnaW5hbEVycm9yOiB7XG4gICAgICAgICAgbmFtZTogZXJyLm5hbWUsXG4gICAgICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UsXG4gICAgICAgICAgY29kZTogZXJyLmNvZGUsXG4gICAgICAgICAgZnVsbDogZXJyXG4gICAgICAgIH1cbiAgICAgIH0pXG4gIH0pO1xuXG4gIC8vIFNlbmQgcmVzcG9uc2UgdG8gY2xpZW50XG4gIHJlcy5zdGF0dXMoZXJyb3Iuc3RhdHVzQ29kZSB8fCA1MDApLmpzb24oe1xuICAgIHN0YXR1czogZXJyb3Iuc3RhdHVzLFxuICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfHwgJ1NvbWV0aGluZyB3ZW50IHdyb25nIScsXG4gICAgLi4uKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnICYmIHsgc3RhY2s6IGVycm9yLnN0YWNrIH0pLFxuICB9KTtcbn07XG5cbmV4cG9ydCB7IGdsb2JhbEVycm9ySGFuZGxlciwgQXBwRXJyb3IgfTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsT0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQXdDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUs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","map":{"version":3,"names":["_logger","_interopRequireDefault","require","e","__esModule","default","AppError","Error","constructor","message","statusCode","status","startsWith","isOperational","captureStackTrace","exports","handleCastErrorDB","err","path","value","handleDuplicateFieldsDB","fieldName","Object","keys","keyPattern","fieldValue","keyValue","handleValidationErrorDB","errors","values","map","el","join","handleJWTError","handleJWTExpiredError","globalErrorHandler","req","res","_next","error","stack","name","code","logLevel","logger","originalUrl","method","ip","process","env","NODE_ENV","originalError","full","json"],"sourceRoot":"/Users/pizzosta/Desktop/CODING/auction-website/server/src/middleware/","sources":["errorHandler.js"],"sourcesContent":["import logger from '../utils/logger.js';\n\n/**\n * Custom error class for handling operational errors\n */\nclass AppError extends Error {\n  constructor(message, statusCode) {\n    super(message);\n    this.statusCode = statusCode;\n    this.status = `${statusCode}`.startsWith('4') ? 'fail' : 'error';\n    this.isOperational = true;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\n/**\n * Error handlers for specific error types\n */\nconst handleCastErrorDB = err => {\n  const message = `Invalid ${err.path}: ${err.value}`;\n  return new AppError(message, 400);\n};\n\nconst handleDuplicateFieldsDB = err => {\n  // Extract the duplicate field key and value\n  const fieldName = Object.keys(err.keyPattern || {})[0] || 'field';\n  const fieldValue = err.keyValue ? err.keyValue[fieldName] : 'unknown';\n\n  let message;\n  switch (fieldName) {\n    case 'email':\n      message = 'An account with this email already exists.';\n      break;\n    case 'username':\n      message = 'This username is already taken.';\n      break;\n    case 'phone':\n      message = 'This phone number is already registered.';\n      break;\n    default:\n      message = `Duplicate value for ${fieldName}: \"${fieldValue}\". Please use another value!`;\n  }\n\n  return new AppError(message, 400);\n};\n\nconst handleValidationErrorDB = err => {\n  const errors = Object.values(err.errors).map(el => el.message);\n  const message = `Invalid input data. ${errors.join('. ')}`;\n  return new AppError(message, 400);\n};\n\nconst handleJWTError = () => new AppError('Invalid token. Please log in again!', 401);\n\nconst handleJWTExpiredError = () =>\n  new AppError('Your token has expired! Please log in again.', 401);\n\n/**\n * Global error handling middleware\n */\nconst globalErrorHandler = (err, req, res, _next) => {\n  err.statusCode = err.statusCode || 500;\n  err.status = err.status || 'error';\n\n  // Normalize the error object\n  let error = { ...err };\n  error.message = err.message;\n  error.stack = err.stack;\n\n  // Handle specific error types\n  if (error.name === 'CastError') error = handleCastErrorDB(error);\n  if (error.code === 11000) error = handleDuplicateFieldsDB(error);\n  if (error.name === 'ValidationError') error = handleValidationErrorDB(error);\n  if (error.name === 'JsonWebTokenError') error = handleJWTError();\n  if (error.name === 'TokenExpiredError') error = handleJWTExpiredError();\n\n  // Determine log level based on error type\n  const logLevel = error.isOperational ? 'warn' : 'error';\n\n  // Log structured error with request context\n  logger[logLevel]('Unhandled error', {\n    status: error.status,\n    statusCode: error.statusCode,\n    message: error.message,\n    stack: error.stack,\n    path: req.originalUrl,\n    method: req.method,\n    ip: req.ip,\n    isOperational: error.isOperational,\n    // Only include stack for non-operational errors in production\n    ...(!error.isOperational && { stack: error.stack }),\n    // Include original error object for debugging in development\n    ...(\n      process.env.NODE_ENV === 'development'\n      && {\n        stack: error.stack,\n        originalError: {\n          name: err.name,\n          message: err.message,\n          code: err.code,\n          full: err\n        }\n      })\n  });\n\n  // Send response to client\n  res.status(error.statusCode || 500).json({\n    status: error.status,\n    message: error.message || 'Something went wrong!',\n    ...(process.env.NODE_ENV === 'development' && { stack: error.stack }),\n  });\n};\n\nexport { globalErrorHandler, AppError };\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAwC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAExC;AACA;AACA;AACA,MAAMG,QAAQ,SAASC,KAAK,CAAC;EAC3BC,WAAWA,CAACC,OAAO,EAAEC,UAAU,EAAE;IAC/B,KAAK,CAACD,OAAO,CAAC;IACd,IAAI,CAACC,UAAU,GAAGA,UAAU;IAC5B,IAAI,CAACC,MAAM,GAAG,GAAGD,UAAU,EAAE,CAACE,UAAU,CAAC,GAAG,CAAC,GAAG,MAAM,GAAG,OAAO;IAChE,IAAI,CAACC,aAAa,GAAG,IAAI;IACzBN,KAAK,CAACO,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAACN,WAAW,CAAC;EACjD;AACF;;AAEA;AACA;AACA;AAFAO,OAAA,CAAAT,QAAA,GAAAA,QAAA;AAGA,MAAMU,iBAAiB,GAAGC,GAAG,IAAI;EAC/B,MAAMR,OAAO,GAAG,WAAWQ,GAAG,CAACC,IAAI,KAAKD,GAAG,CAACE,KAAK,EAAE;EACnD,OAAO,IAAIb,QAAQ,CAACG,OAAO,EAAE,GAAG,CAAC;AACnC,CAAC;AAED,MAAMW,uBAAuB,GAAGH,GAAG,IAAI;EACrC;EACA,MAAMI,SAAS,GAAGC,MAAM,CAACC,IAAI,CAACN,GAAG,CAACO,UAAU,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,OAAO;EACjE,MAAMC,UAAU,GAAGR,GAAG,CAACS,QAAQ,GAAGT,GAAG,CAACS,QAAQ,CAACL,SAAS,CAAC,GAAG,SAAS;EAErE,IAAIZ,OAAO;EACX,QAAQY,SAAS;IACf,KAAK,OAAO;MACVZ,OAAO,GAAG,4CAA4C;MACtD;IACF,KAAK,UAAU;MACbA,OAAO,GAAG,iCAAiC;MAC3C;IACF,KAAK,OAAO;MACVA,OAAO,GAAG,0CAA0C;MACpD;IACF;MACEA,OAAO,GAAG,uBAAuBY,SAAS,MAAMI,UAAU,8BAA8B;EAC5F;EAEA,OAAO,IAAInB,QAAQ,CAACG,OAAO,EAAE,GAAG,CAAC;AACnC,CAAC;AAED,MAAMkB,uBAAuB,GAAGV,GAAG,IAAI;EACrC,MAAMW,MAAM,GAAGN,MAAM,CAACO,MAAM,CAACZ,GAAG,CAACW,MAAM,CAAC,CAACE,GAAG,CAACC,EAAE,IAAIA,EAAE,CAACtB,OAAO,CAAC;EAC9D,MAAMA,OAAO,GAAG,uBAAuBmB,MAAM,CAACI,IAAI,CAAC,IAAI,CAAC,EAAE;EAC1D,OAAO,IAAI1B,QAAQ,CAACG,OAAO,EAAE,GAAG,CAAC;AACnC,CAAC;AAED,MAAMwB,cAAc,GAAGA,CAAA,KAAM,IAAI3B,QAAQ,CAAC,qCAAqC,EAAE,GAAG,CAAC;AAErF,MAAM4B,qBAAqB,GAAGA,CAAA,KAC5B,IAAI5B,QAAQ,CAAC,8CAA8C,EAAE,GAAG,CAAC;;AAEnE;AACA;AACA;AACA,MAAM6B,kBAAkB,GAAGA,CAAClB,GAAG,EAAEmB,GAAG,EAAEC,GAAG,EAAEC,KAAK,KAAK;EACnDrB,GAAG,CAACP,UAAU,GAAGO,GAAG,CAACP,UAAU,IAAI,GAAG;EACtCO,GAAG,CAACN,MAAM,GAAGM,GAAG,CAACN,MAAM,IAAI,OAAO;;EAElC;EACA,IAAI4B,KAAK,GAAG;IAAE,GAAGtB;EAAI,CAAC;EACtBsB,KAAK,CAAC9B,OAAO,GAAGQ,GAAG,CAACR,OAAO;EAC3B8B,KAAK,CAACC,KAAK,GAAGvB,GAAG,CAACuB,KAAK;;EAEvB;EACA,IAAID,KAAK,CAACE,IAAI,KAAK,WAAW,EAAEF,KAAK,GAAGvB,iBAAiB,CAACuB,KAAK,CAAC;EAChE,IAAIA,KAAK,CAACG,IAAI,KAAK,KAAK,EAAEH,KAAK,GAAGnB,uBAAuB,CAACmB,KAAK,CAAC;EAChE,IAAIA,KAAK,CAACE,IAAI,KAAK,iBAAiB,EAAEF,KAAK,GAAGZ,uBAAuB,CAACY,KAAK,CAAC;EAC5E,IAAIA,KAAK,CAACE,IAAI,KAAK,mBAAmB,EAAEF,KAAK,GAAGN,cAAc,CAAC,CAAC;EAChE,IAAIM,KAAK,CAACE,IAAI,KAAK,mBAAmB,EAAEF,KAAK,GAAGL,qBAAqB,CAAC,CAAC;;EAEvE;EACA,MAAMS,QAAQ,GAAGJ,KAAK,CAAC1B,aAAa,GAAG,MAAM,GAAG,OAAO;;EAEvD;EACA+B,eAAM,CAACD,QAAQ,CAAC,CAAC,iBAAiB,EAAE;IAClChC,MAAM,EAAE4B,KAAK,CAAC5B,MAAM;IACpBD,UAAU,EAAE6B,KAAK,CAAC7B,UAAU;IAC5BD,OAAO,EAAE8B,KAAK,CAAC9B,OAAO;IACtB+B,KAAK,EAAED,KAAK,CAACC,KAAK;IAClBtB,IAAI,EAAEkB,GAAG,CAACS,WAAW;IACrBC,MAAM,EAAEV,GAAG,CAACU,MAAM;IAClBC,EAAE,EAAEX,GAAG,CAACW,EAAE;IACVlC,aAAa,EAAE0B,KAAK,CAAC1B,aAAa;IAClC;IACA,IAAI,CAAC0B,KAAK,CAAC1B,aAAa,IAAI;MAAE2B,KAAK,EAAED,KAAK,CAACC;IAAM,CAAC,CAAC;IACnD;IACA,IACEQ,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,IACnC;MACDV,KAAK,EAAED,KAAK,CAACC,KAAK;MAClBW,aAAa,EAAE;QACbV,IAAI,EAAExB,GAAG,CAACwB,IAAI;QACdhC,OAAO,EAAEQ,GAAG,CAACR,OAAO;QACpBiC,IAAI,EAAEzB,GAAG,CAACyB,IAAI;QACdU,IAAI,EAAEnC;MACR;IACF,CAAC;EACL,CAAC,CAAC;;EAEF;EACAoB,GAAG,CAAC1B,MAAM,CAAC4B,KAAK,CAAC7B,UAAU,IAAI,GAAG,CAAC,CAAC2C,IAAI,CAAC;IACvC1C,MAAM,EAAE4B,KAAK,CAAC5B,MAAM;IACpBF,OAAO,EAAE8B,KAAK,CAAC9B,OAAO,IAAI,uBAAuB;IACjD,IAAIuC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,IAAI;MAAEV,KAAK,EAAED,KAAK,CAACC;IAAM,CAAC;EACtE,CAAC,CAAC;AACJ,CAAC;AAACzB,OAAA,CAAAoB,kBAAA,GAAAA,kBAAA","ignoreList":[]}},"mtime":1756466382046},"{\"assumptions\":{},\"sourceRoot\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/src/utils/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"filename\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/src/utils/logger.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"test\",\"root\":\"/Users/pizzosta/Desktop/CODING/auction-website/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-explicit-resource-management\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"BlockStatement\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/pizzosta/Desktop/CODING/auction-website/server/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.28.3:test":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.httpLogger = exports.default = void 0;\nvar _winston = _interopRequireDefault(require(\"winston\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _url = require(\"url\");\nvar _fs = _interopRequireDefault(require(\"fs\"));\nvar _morgan = _interopRequireDefault(require(\"morgan\"));\nvar _requestContext = require(\"../middleware/requestContext.js\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst _filename = (0, _url.fileURLToPath)(import.meta.url);\nconst _dirname = _path.default.dirname(_filename);\n\n// Create logs directory if it doesn't exist\nconst logDir = _path.default.join(process.cwd(), 'logs');\nif (!_fs.default.existsSync(logDir)) {\n  _fs.default.mkdirSync(logDir);\n}\n\n// Custom format to inject requestId\nconst requestIdFormat = _winston.default.format(info => {\n  const context = (0, _requestContext.getRequestContext)();\n  if (context.requestId) {\n    info.requestId = context.requestId;\n  }\n  return info;\n});\n\n// Define log format\nconst logFormat = _winston.default.format.combine(requestIdFormat(), _winston.default.format.timestamp({\n  format: 'YYYY-MM-DD HH:mm:ss'\n}), _winston.default.format.errors({\n  stack: true\n}), _winston.default.format.splat(), _winston.default.format.json());\n\n// Create logger instance\nconst logger = _winston.default.createLogger({\n  level: process.env.NODE_ENV === 'production' ? 'info' : 'debug',\n  format: logFormat,\n  defaultMeta: {\n    service: 'auction-website'\n  },\n  transports: [\n  // Write all logs with level `error` and below to `error.log`\n  new _winston.default.transports.File({\n    filename: _path.default.join(logDir, 'error.log'),\n    level: 'error',\n    maxsize: 5 * 1024 * 1024,\n    // 5MB\n    maxFiles: 5,\n    tailable: true\n  }),\n  // Write all logs with level `info` and below to `combined.log`\n  new _winston.default.transports.File({\n    filename: _path.default.join(logDir, 'combined.log'),\n    maxsize: 10 * 1024 * 1024,\n    // 10MB\n    maxFiles: 5,\n    tailable: true\n  })]\n});\n\n// Add console transport in non-production environments\nif (process.env.NODE_ENV !== 'production') {\n  logger.add(new _winston.default.transports.Console({\n    format: _winston.default.format.combine(_winston.default.format.colorize(), _winston.default.format.simple(), _winston.default.format.printf(({\n      level,\n      message,\n      requestId,\n      ...meta\n    }) => {\n      return `${requestId} ${level}: ${message} ${Object.keys(meta).length ? JSON.stringify(meta, null, 2) : ''}`;\n    })),\n    level: 'debug'\n  }));\n}\n\n// Create a Morgan token for requestId\n_morgan.default.token('requestId', req => req.requestId || 'no-id');\n\n// Define Morgan format string\nconst morganFormat = ':requestId :method :url :status :res[content-length] - :response-time ms';\n\n// Create a Morgan middleware that logs via Winston\nconst httpLogger = exports.httpLogger = (0, _morgan.default)(morganFormat, {\n  stream: {\n    write: message => {\n      logger.http(message.trim());\n    }\n  }\n});\n\n// Patch logger methods so requestId is always included (error, warn, info, etc.)\nconst levelsToPatch = ['error', 'warn', 'info', 'debug', 'http'];\nfor (const level of levelsToPatch) {\n  const originalFn = logger[level].bind(logger);\n  logger[level] = (msg, meta = {}) => {\n    const context = (0, _requestContext.getRequestContext)();\n    if (context?.requestId && !meta.requestId) {\n      meta.requestId = context.requestId;\n    }\n    return originalFn(msg, meta);\n  };\n}\nvar _default = exports.default = logger;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfd2luc3RvbiIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3BhdGgiLCJfdXJsIiwiX2ZzIiwiX21vcmdhbiIsIl9yZXF1ZXN0Q29udGV4dCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9fZmlsZW5hbWUiLCJmaWxlVVJMVG9QYXRoIiwiaW1wb3J0IiwibWV0YSIsInVybCIsIl9fZGlybmFtZSIsInBhdGgiLCJkaXJuYW1lIiwibG9nRGlyIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJmcyIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZXF1ZXN0SWRGb3JtYXQiLCJ3aW5zdG9uIiwiZm9ybWF0IiwiaW5mbyIsImNvbnRleHQiLCJnZXRSZXF1ZXN0Q29udGV4dCIsInJlcXVlc3RJZCIsImxvZ0Zvcm1hdCIsImNvbWJpbmUiLCJ0aW1lc3RhbXAiLCJlcnJvcnMiLCJzdGFjayIsInNwbGF0IiwianNvbiIsImxvZ2dlciIsImNyZWF0ZUxvZ2dlciIsImxldmVsIiwiZW52IiwiTk9ERV9FTlYiLCJkZWZhdWx0TWV0YSIsInNlcnZpY2UiLCJ0cmFuc3BvcnRzIiwiRmlsZSIsImZpbGVuYW1lIiwibWF4c2l6ZSIsIm1heEZpbGVzIiwidGFpbGFibGUiLCJhZGQiLCJDb25zb2xlIiwiY29sb3JpemUiLCJzaW1wbGUiLCJwcmludGYiLCJtZXNzYWdlIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsIkpTT04iLCJzdHJpbmdpZnkiLCJtb3JnYW4iLCJ0b2tlbiIsInJlcSIsIm1vcmdhbkZvcm1hdCIsImh0dHBMb2dnZXIiLCJleHBvcnRzIiwic3RyZWFtIiwid3JpdGUiLCJodHRwIiwidHJpbSIsImxldmVsc1RvUGF0Y2giLCJvcmlnaW5hbEZuIiwiYmluZCIsIm1zZyIsIl9kZWZhdWx0Il0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcGl6em9zdGEvRGVza3RvcC9DT0RJTkcvYXVjdGlvbi13ZWJzaXRlL3NlcnZlci9zcmMvdXRpbHMvIiwic291cmNlcyI6WyJsb2dnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHdpbnN0b24gZnJvbSAnd2luc3Rvbic7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IGZpbGVVUkxUb1BhdGggfSBmcm9tICd1cmwnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBtb3JnYW4gZnJvbSAnbW9yZ2FuJztcbmltcG9ydCB7IGdldFJlcXVlc3RDb250ZXh0IH0gZnJvbSAnLi4vbWlkZGxld2FyZS9yZXF1ZXN0Q29udGV4dC5qcyc7XG5cbmNvbnN0IF9fZmlsZW5hbWUgPSBmaWxlVVJMVG9QYXRoKGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCBfX2Rpcm5hbWUgPSBwYXRoLmRpcm5hbWUoX19maWxlbmFtZSk7XG5cbi8vIENyZWF0ZSBsb2dzIGRpcmVjdG9yeSBpZiBpdCBkb2Vzbid0IGV4aXN0XG5jb25zdCBsb2dEaXIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2xvZ3MnKTtcbmlmICghZnMuZXhpc3RzU3luYyhsb2dEaXIpKSB7XG4gIGZzLm1rZGlyU3luYyhsb2dEaXIpO1xufVxuXG4vLyBDdXN0b20gZm9ybWF0IHRvIGluamVjdCByZXF1ZXN0SWRcbmNvbnN0IHJlcXVlc3RJZEZvcm1hdCA9IHdpbnN0b24uZm9ybWF0KChpbmZvKSA9PiB7XG4gIGNvbnN0IGNvbnRleHQgPSBnZXRSZXF1ZXN0Q29udGV4dCgpO1xuICBpZiAoY29udGV4dC5yZXF1ZXN0SWQpIHtcbiAgICBpbmZvLnJlcXVlc3RJZCA9IGNvbnRleHQucmVxdWVzdElkO1xuICB9XG4gIHJldHVybiBpbmZvO1xufSk7XG5cbi8vIERlZmluZSBsb2cgZm9ybWF0XG5jb25zdCBsb2dGb3JtYXQgPSB3aW5zdG9uLmZvcm1hdC5jb21iaW5lKFxuICByZXF1ZXN0SWRGb3JtYXQoKSxcbiAgd2luc3Rvbi5mb3JtYXQudGltZXN0YW1wKHsgZm9ybWF0OiAnWVlZWS1NTS1ERCBISDptbTpzcycgfSksXG4gIHdpbnN0b24uZm9ybWF0LmVycm9ycyh7IHN0YWNrOiB0cnVlIH0pLFxuICB3aW5zdG9uLmZvcm1hdC5zcGxhdCgpLFxuICB3aW5zdG9uLmZvcm1hdC5qc29uKCksXG4pO1xuXG4vLyBDcmVhdGUgbG9nZ2VyIGluc3RhbmNlXG5jb25zdCBsb2dnZXIgPSB3aW5zdG9uLmNyZWF0ZUxvZ2dlcih7XG4gIGxldmVsOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJ2luZm8nIDogJ2RlYnVnJyxcbiAgZm9ybWF0OiBsb2dGb3JtYXQsXG4gIGRlZmF1bHRNZXRhOiB7IHNlcnZpY2U6ICdhdWN0aW9uLXdlYnNpdGUnIH0sXG4gIHRyYW5zcG9ydHM6IFtcbiAgICAvLyBXcml0ZSBhbGwgbG9ncyB3aXRoIGxldmVsIGBlcnJvcmAgYW5kIGJlbG93IHRvIGBlcnJvci5sb2dgXG4gICAgbmV3IHdpbnN0b24udHJhbnNwb3J0cy5GaWxlKHtcbiAgICAgIGZpbGVuYW1lOiBwYXRoLmpvaW4obG9nRGlyLCAnZXJyb3IubG9nJyksXG4gICAgICBsZXZlbDogJ2Vycm9yJyxcbiAgICAgIG1heHNpemU6IDUgKiAxMDI0ICogMTAyNCwgLy8gNU1CXG4gICAgICBtYXhGaWxlczogNSxcbiAgICAgIHRhaWxhYmxlOiB0cnVlLFxuICAgIH0pLFxuICAgIC8vIFdyaXRlIGFsbCBsb2dzIHdpdGggbGV2ZWwgYGluZm9gIGFuZCBiZWxvdyB0byBgY29tYmluZWQubG9nYFxuICAgIG5ldyB3aW5zdG9uLnRyYW5zcG9ydHMuRmlsZSh7XG4gICAgICBmaWxlbmFtZTogcGF0aC5qb2luKGxvZ0RpciwgJ2NvbWJpbmVkLmxvZycpLFxuICAgICAgbWF4c2l6ZTogMTAgKiAxMDI0ICogMTAyNCwgLy8gMTBNQlxuICAgICAgbWF4RmlsZXM6IDUsXG4gICAgICB0YWlsYWJsZTogdHJ1ZSxcbiAgICB9KSxcbiAgXSxcbn0pO1xuXG4vLyBBZGQgY29uc29sZSB0cmFuc3BvcnQgaW4gbm9uLXByb2R1Y3Rpb24gZW52aXJvbm1lbnRzXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICBsb2dnZXIuYWRkKFxuICAgIG5ldyB3aW5zdG9uLnRyYW5zcG9ydHMuQ29uc29sZSh7XG4gICAgICBmb3JtYXQ6IHdpbnN0b24uZm9ybWF0LmNvbWJpbmUoXG4gICAgICAgIHdpbnN0b24uZm9ybWF0LmNvbG9yaXplKCksXG4gICAgICAgIHdpbnN0b24uZm9ybWF0LnNpbXBsZSgpLFxuICAgICAgICB3aW5zdG9uLmZvcm1hdC5wcmludGYoKHsgbGV2ZWwsIG1lc3NhZ2UsIHJlcXVlc3RJZCwgLi4ubWV0YSB9KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGAke3JlcXVlc3RJZH0gJHtsZXZlbH06ICR7bWVzc2FnZX0gJHtPYmplY3Qua2V5cyhtZXRhKS5sZW5ndGggPyBKU09OLnN0cmluZ2lmeShtZXRhLCBudWxsLCAyKSA6ICcnfWA7XG4gICAgICAgIH0pXG4gICAgICApLFxuICAgICAgbGV2ZWw6ICdkZWJ1ZycsXG4gICAgfSksXG4gICk7XG59XG5cbi8vIENyZWF0ZSBhIE1vcmdhbiB0b2tlbiBmb3IgcmVxdWVzdElkXG5tb3JnYW4udG9rZW4oJ3JlcXVlc3RJZCcsIChyZXEpID0+IHJlcS5yZXF1ZXN0SWQgfHwgJ25vLWlkJyk7XG5cbi8vIERlZmluZSBNb3JnYW4gZm9ybWF0IHN0cmluZ1xuY29uc3QgbW9yZ2FuRm9ybWF0ID1cbiAgJzpyZXF1ZXN0SWQgOm1ldGhvZCA6dXJsIDpzdGF0dXMgOnJlc1tjb250ZW50LWxlbmd0aF0gLSA6cmVzcG9uc2UtdGltZSBtcyc7XG5cbi8vIENyZWF0ZSBhIE1vcmdhbiBtaWRkbGV3YXJlIHRoYXQgbG9ncyB2aWEgV2luc3RvblxuZXhwb3J0IGNvbnN0IGh0dHBMb2dnZXIgPSBtb3JnYW4obW9yZ2FuRm9ybWF0LCB7XG4gIHN0cmVhbToge1xuICAgIHdyaXRlOiAobWVzc2FnZSkgPT4ge1xuICAgICAgbG9nZ2VyLmh0dHAobWVzc2FnZS50cmltKCkpO1xuICAgIH0sXG4gIH0sXG59KTtcblxuLy8gUGF0Y2ggbG9nZ2VyIG1ldGhvZHMgc28gcmVxdWVzdElkIGlzIGFsd2F5cyBpbmNsdWRlZCAoZXJyb3IsIHdhcm4sIGluZm8sIGV0Yy4pXG5jb25zdCBsZXZlbHNUb1BhdGNoID0gWydlcnJvcicsICd3YXJuJywgJ2luZm8nLCAnZGVidWcnLCAnaHR0cCddO1xuZm9yIChjb25zdCBsZXZlbCBvZiBsZXZlbHNUb1BhdGNoKSB7XG4gIGNvbnN0IG9yaWdpbmFsRm4gPSBsb2dnZXJbbGV2ZWxdLmJpbmQobG9nZ2VyKTtcbiAgbG9nZ2VyW2xldmVsXSA9IChtc2csIG1ldGEgPSB7fSkgPT4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSBnZXRSZXF1ZXN0Q29udGV4dCgpO1xuICAgIGlmIChjb250ZXh0Py5yZXF1ZXN0SWQgJiYgIW1ldGEucmVxdWVzdElkKSB7XG4gICAgICBtZXRhLnJlcXVlc3RJZCA9IGNvbnRleHQucmVxdWVzdElkO1xuICAgIH1cbiAgICByZXR1cm4gb3JpZ2luYWxGbihtc2csIG1ldGEpO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBsb2dnZXI7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLElBQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLEdBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLE9BQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLGVBQUEsR0FBQUwsT0FBQTtBQUFvRSxTQUFBRCx1QkFBQU8sQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVwRSxNQUFNRyxTQUFVLEdBQUcsSUFBQUMsa0JBQWEsRUFBQ0MsTUFBTSxDQUFDQyxJQUFJLENBQUNDLEdBQUcsQ0FBQztB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","map":{"version":3,"names":["_winston","_interopRequireDefault","require","_path","_url","_fs","_morgan","_requestContext","e","__esModule","default","__filename","fileURLToPath","import","meta","url","__dirname","path","dirname","logDir","join","process","cwd","fs","existsSync","mkdirSync","requestIdFormat","winston","format","info","context","getRequestContext","requestId","logFormat","combine","timestamp","errors","stack","splat","json","logger","createLogger","level","env","NODE_ENV","defaultMeta","service","transports","File","filename","maxsize","maxFiles","tailable","add","Console","colorize","simple","printf","message","Object","keys","length","JSON","stringify","morgan","token","req","morganFormat","httpLogger","exports","stream","write","http","trim","levelsToPatch","originalFn","bind","msg","_default"],"sourceRoot":"/Users/pizzosta/Desktop/CODING/auction-website/server/src/utils/","sources":["logger.js"],"sourcesContent":["import winston from 'winston';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\nimport fs from 'fs';\nimport morgan from 'morgan';\nimport { getRequestContext } from '../middleware/requestContext.js';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\n// Create logs directory if it doesn't exist\nconst logDir = path.join(process.cwd(), 'logs');\nif (!fs.existsSync(logDir)) {\n  fs.mkdirSync(logDir);\n}\n\n// Custom format to inject requestId\nconst requestIdFormat = winston.format((info) => {\n  const context = getRequestContext();\n  if (context.requestId) {\n    info.requestId = context.requestId;\n  }\n  return info;\n});\n\n// Define log format\nconst logFormat = winston.format.combine(\n  requestIdFormat(),\n  winston.format.timestamp({ format: 'YYYY-MM-DD HH:mm:ss' }),\n  winston.format.errors({ stack: true }),\n  winston.format.splat(),\n  winston.format.json(),\n);\n\n// Create logger instance\nconst logger = winston.createLogger({\n  level: process.env.NODE_ENV === 'production' ? 'info' : 'debug',\n  format: logFormat,\n  defaultMeta: { service: 'auction-website' },\n  transports: [\n    // Write all logs with level `error` and below to `error.log`\n    new winston.transports.File({\n      filename: path.join(logDir, 'error.log'),\n      level: 'error',\n      maxsize: 5 * 1024 * 1024, // 5MB\n      maxFiles: 5,\n      tailable: true,\n    }),\n    // Write all logs with level `info` and below to `combined.log`\n    new winston.transports.File({\n      filename: path.join(logDir, 'combined.log'),\n      maxsize: 10 * 1024 * 1024, // 10MB\n      maxFiles: 5,\n      tailable: true,\n    }),\n  ],\n});\n\n// Add console transport in non-production environments\nif (process.env.NODE_ENV !== 'production') {\n  logger.add(\n    new winston.transports.Console({\n      format: winston.format.combine(\n        winston.format.colorize(),\n        winston.format.simple(),\n        winston.format.printf(({ level, message, requestId, ...meta }) => {\n          return `${requestId} ${level}: ${message} ${Object.keys(meta).length ? JSON.stringify(meta, null, 2) : ''}`;\n        })\n      ),\n      level: 'debug',\n    }),\n  );\n}\n\n// Create a Morgan token for requestId\nmorgan.token('requestId', (req) => req.requestId || 'no-id');\n\n// Define Morgan format string\nconst morganFormat =\n  ':requestId :method :url :status :res[content-length] - :response-time ms';\n\n// Create a Morgan middleware that logs via Winston\nexport const httpLogger = morgan(morganFormat, {\n  stream: {\n    write: (message) => {\n      logger.http(message.trim());\n    },\n  },\n});\n\n// Patch logger methods so requestId is always included (error, warn, info, etc.)\nconst levelsToPatch = ['error', 'warn', 'info', 'debug', 'http'];\nfor (const level of levelsToPatch) {\n  const originalFn = logger[level].bind(logger);\n  logger[level] = (msg, meta = {}) => {\n    const context = getRequestContext();\n    if (context?.requestId && !meta.requestId) {\n      meta.requestId = context.requestId;\n    }\n    return originalFn(msg, meta);\n  };\n}\n\nexport default logger;\n"],"mappings":"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","ignoreList":[]}},"mtime":1756426062954}}